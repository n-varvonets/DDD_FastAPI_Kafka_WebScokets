# –û—Ç–≤–µ—Ç—ã –Ω–∞ –≤–æ–ø—Ä–æ—Å—ã –ø–æ `Generic` –∏ `Value Objects`

## 1. –î–∂–µ–Ω–µ—Ä–∏–∫–∏ —Ç–æ–ª—å–∫–æ –≤ `values`, —á—Ç–æ–±—ã –æ–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ `entity`?

–°—É–¥—è –ø–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–µ –ø—Ä–æ–µ–∫—Ç–∞, `values` —Å–æ–¥–µ—Ä–∂–∏—Ç —Ñ–∞–π–ª—ã, –∫–æ—Ç–æ—Ä—ã–µ —Ä–µ–∞–ª–∏–∑—É—é—Ç **Value Objects** (–æ–±—ä–µ–∫—Ç—ã-–∑–Ω–∞—á–µ–Ω–∏—è) –¥–ª—è —Ä–∞–±–æ—Ç—ã **—Å –∞—Ç—Ä–∏–±—É—Ç–∞–º–∏** —Å—É—â–Ω–æ—Å—Ç–µ–π (`entities`).
–≠—Ç–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç **DDD (Domain-Driven Design)**, –≥–¥–µ Value Object —Å–ª—É–∂–∏—Ç –¥–ª—è –ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π, —Ç–∞–∫–∏—Ö –∫–∞–∫ `Money`, `Amount`, `Email`.

–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ **–¥–∂–µ–Ω–µ—Ä–∏–∫–æ–≤** (`Generic[T]`) –≤ `values` –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ–ø–∏—Å—ã–≤–∞—Ç—å **–æ–±–æ–±—â–µ–Ω–Ω—ã–µ –∑–Ω–∞—á–µ–Ω–∏—è**, –Ω–∞–ø—Ä–∏–º–µ—Ä, `Money[float]` –∏–ª–∏ `Money[Decimal]`, –Ω–µ –ø—Ä–∏–≤—è–∑—ã–≤–∞—è—Å—å –∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–º—É —Ç–∏–ø—É.

## –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ –¥–∂–µ–Ω–µ—Ä–∏–∫–∏ —Ç–æ–ª—å–∫–æ –≤ values?
–ù–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ. –î–∂–µ–Ω–µ—Ä–∏–∫–∏ (Generic[T]) –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è:

- –í Value Objects (values/) ‚Äî —á—Ç–æ–±—ã —Å–¥–µ–ª–∞—Ç—å –æ–±—ä–µ–∫—Ç—ã –±–æ–ª–µ–µ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, —Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∑–Ω–∞—á–µ–Ω–∏–π).
- –í Entities (entities/) ‚Äî –µ—Å–ª–∏ –Ω—É–∂–Ω–æ —Å–¥–µ–ª–∞—Ç—å —Å—É—â–Ω–æ—Å—Ç–∏ —É–Ω–∏–≤–µ—Ä—Å–∞–ª—å–Ω—ã–º–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, Generic[IDType] –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–æ–≤).
- –í Exceptions / Events ‚Äî —Ä–µ–∂–µ, –Ω–æ –µ—Å–ª–∏, –Ω–∞–ø—Ä–∏–º–µ—Ä, –æ—à–∏–±–∫–∞ –¥–æ–ª–∂–Ω–∞ —Ä–∞–±–æ—Ç–∞—Ç—å —Å —Ä–∞–∑–Ω—ã–º–∏ —Ç–∏–ø–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö.

‚úÖ **–í—ã–≤–æ–¥:** –î–∂–µ–Ω–µ—Ä–∏–∫–∏ –ª–æ–≥–∏—á–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å **–∏–º–µ–Ω–Ω–æ –≤ values**, —á—Ç–æ–±—ã –∑–∞–¥–∞–≤–∞—Ç—å **—Ä–∞–∑–Ω—ã–µ —Ç–∏–ø—ã –∑–Ω–∞—á–µ–Ω–∏–π** –¥–ª—è —Å—É—â–Ω–æ—Å—Ç–µ–π.

---

## 2. –ß—Ç–æ –±—É–¥–µ—Ç, –µ—Å–ª–∏:
- `bound=–¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ`?
- `frozen=False`?

### üîπ `bound=–¥—Ä—É–≥–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ`
–ü—Ä–∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–∏ `TypeVar("T", bound=SomeClass)` –¥–∂–µ–Ω–µ—Ä–∏–∫ **–æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç—Å—è** —ç—Ç–∏–º –∫–ª–∞—Å—Å–æ–º –∏–ª–∏ –µ–≥–æ –ø–æ–¥–∫–ª–∞—Å—Å–∞–º–∏.

–ü—Ä–∏–º–µ—Ä:
```python
T = TypeVar("T", bound=int)  # –¢–µ–ø–µ—Ä—å T –º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ int –∏–ª–∏ –µ–≥–æ –ø–æ–¥–∫–ª–∞—Å—Å–∞–º–∏
```
–ï—Å–ª–∏ —É–∫–∞–∑–∞—Ç—å bound=str, —Ç–æ —Ç–∏–ø T —Å–º–æ–∂–µ—Ç –±—ã—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫–∞–º–∏.

‚ùó –ò–∑–º–µ–Ω–µ–Ω–∏–µ bound –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç, –∫–∞–∫–∏–µ —Ç–∏–ø—ã –º–æ–∂–Ω–æ –ø–æ–¥—Å—Ç–∞–≤–ª—è—Ç—å.
–ù–∞–ø—Ä–∏–º–µ—Ä:
```python
class Money(Generic[T]):
    amount: T

m = Money[str]()  # –û—à–∏–±–∫–∞, –µ—Å–ª–∏ bound=int
```
---
üîπ frozen=False  
- –ï—Å–ª–∏ –≤ @dataclass —É–∫–∞–∑–∞—Ç—å frozen=True, —Ç–æ –æ–±—ä–µ–∫—Ç —Å—Ç–∞–Ω–æ–≤–∏—Ç—Å—è –Ω–µ–∏–∑–º–µ–Ω—è–µ–º—ã–º.

```python
@dataclass(frozen=True)
class Money:
    amount: int
```
–ü–æ–ø—ã—Ç–∫–∞ –∏–∑–º–µ–Ω–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ:

```python
m = Money(100)
m.amount = 200  # –û—à–∏–±–∫–∞!
```
–ï—Å–ª–∏ frozen=False, –æ–±—ä–µ–∫—Ç –º–æ–∂–Ω–æ –∏–∑–º–µ–Ω—è—Ç—å:

```python
@dataclass(frozen=False)
class Money:
    amount: int

m = Money(100)
m.amount = 200  # –†–∞–±–æ—Ç–∞–µ—Ç!
```
‚úÖ –í—ã–≤–æ–¥:

bound=... –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç –¥–æ–ø—É—Å—Ç–∏–º—ã–µ —Ç–∏–ø—ã –¥–∂–µ–Ω–µ—Ä–∏–∫–∞.  
frozen=False –¥–µ–ª–∞–µ—Ç –æ–±—ä–µ–∫—Ç –∏–∑–º–µ–Ω—è–µ–º—ã–º, —á—Ç–æ –Ω–µ –≤—Å–µ–≥–¥–∞ —Ö–æ—Ä–æ—à–æ –¥–ª—è Value Object.
---
3. –ú–æ–∂–Ω–æ –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ –∑–Ω–∞—á–µ–Ω–∏–π, –æ–¥–∏–Ω –∏–∑ –∫–æ—Ç–æ—Ä—ã—Ö VT?  
–î–∞, –º–æ–∂–Ω–æ! –ù–∞–ø—Ä–∏–º–µ—Ä:

```python
class Money(Generic[VT, str]):
    amount: VT
    currency: str
```
–ù–æ –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± ‚Äì –ø–µ—Ä–µ–¥–∞—Ç—å –Ω–µ—Å–∫–æ–ª—å–∫–æ TypeVar:

```python
T = TypeVar("T")  
C = TypeVar("C", bound=str)  # –í–∞–ª—é—Ç–∞ –¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å —Å—Ç—Ä–æ–∫–æ–π

class Money(Generic[T, C]):
    amount: T
    currency: C
```
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ
```python
m = Money[int, str]()
m.amount = 100
m.currency = "USD"
```

---
üî• –ò—Ç–æ–≥:  
- `as_generic_type` ‚Äì –ø—Ä–∏–≤–æ–¥–∏—Ç TypeVar –∫ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–º—É Python-—Ç–∏–ø—É (str, int –∏ —Ç. –¥.).  
- `__post_init__` ‚Äì –≤—ã–ø–æ–ª–Ω—è–µ—Ç –ø–æ—Å—Ç-–æ–±—Ä–∞–±–æ—Ç–∫—É –∑–Ω–∞—á–µ–Ω–∏–π –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ –æ–±—ä–µ–∫—Ç–∞ (–≤–∞–ª–∏–¥–∞—Ü–∏—è, –Ω–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è, –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö).  

## üîπ –ó–∞—á–µ–º `as_generic_type`?
–ú–µ—Ç–æ–¥ `as_generic_type` **–∫–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ—Ç –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ `TypeVar` –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π Python-–æ–±—ä–µ–∫—Ç** (–æ–±—ã—á–Ω–æ —Å—Ç—Ä–æ–∫—É).  
–≠—Ç–æ –ø–æ—Ö–æ–∂–µ –Ω–∞ —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ç–æ—Ä—ã –≤ Django, –Ω–æ **–±–µ–∑ JSON-—Å—Ç—Ä—É–∫—Ç—É—Ä—ã** ‚Äì –ø—Ä–æ—Å—Ç–æ –ø—Ä–∏–≤–µ–¥–µ–Ω–∏–µ —Ç–∏–ø–∞.

### üìå –ü—Ä–∏–º–µ—Ä—ã:
```python
def as_generic_type(self):
    return str(self.value)
```
–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:

```python
val = SomeValue(UUID("550e8400-e29b-41d4-a716-446655440000"))
print(val.as_generic_type())  # "550e8400-e29b-41d4-a716-446655440000"
```
üîπ –í –∫–∞–∫–∏—Ö —Å–ª—É—á–∞—è—Ö –ø–æ–ª–µ–∑–µ–Ω __post_init__?  
–ú–µ—Ç–æ–¥ __post_init__ –≤ dataclass –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏.  
–ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –¥–ª—è:  

–ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö (—É–±—Ä–∞—Ç—å –ø—Ä–æ–±–µ–ª—ã, –∏–∑–º–µ–Ω–∏—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä).
–ê–≤—Ç–æ–≤–∞–ª–∏–¥–∞—Ü–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, –ø—Ä–æ–≤–µ—Ä–∫–∞ UUID).
–ì–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∑–Ω–∞—á–µ–Ω–∏–π –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é.
üìå –ü—Ä–∏–º–µ—Ä—ã:
üîπ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è —Å—Ç—Ä–æ–∫–∏:
```python
@dataclass
class Title:
    value: str

    def __post_init__(self):
        self.value = self.value.strip().capitalize()

title = Title("  hello world  ")
print(title.value)  # "Hello world"
```
üîπ –ó–Ω–∞—á–µ–Ω–∏–µ –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥—Ä—É–≥–∏—Ö –∞—Ä–≥—É–º–µ–Ω—Ç–æ–≤:


```python
@dataclass
class User:
    username: str
    normalized_name: str = field(init=False)

    def __post_init__(self):
        self.normalized_name = self.username.lower()

user = User("JohnDoe")
print(user.normalized_name)  # "johndoe"

```

